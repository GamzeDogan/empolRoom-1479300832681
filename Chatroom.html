<!doctype html>
<html>
<head>
<title>Empol</title>
</head>

<style>
body {
	font: 13px Arial;
	background: #C6C6C6;
	box-sizing: border-box;
}

.serverPW{
	background: #eee;
	width: 35%;
	height: 45%;
	font: 18px Arial;
	font-color: black;
 	position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	display: none;
	-webkit-border-radius: 9px;
    -moz-border-radius: 9px;
	border-radius: 9px;
}

#serverPwButton {
	-moz-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	-webkit-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	box-shadow: inset 0px 1px 3px 0px #91b8b3;
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #44b395), color-stop(1, #6c7c7c));
	background: -moz-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -webkit-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -o-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -ms-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: linear-gradient(to bottom, #44b395 5%, #6c7c7c 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#44b395', endColorstr='#6c7c7c',GradientType=0);
	background-color: #44b395;
	border: 1px solid #566963;
	display: inline-block;
	cursor: pointer;
	color: #ffffff;
	font-family: Arial;
	font-size: 15px;
	font-weight: bold;
	padding: 11px 23px;
	text-decoration: none;
	text-shadow: 0px -1px 0px #2b8a7c;
    position: absolute;
    top: auto;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
    margin-top: 43%;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#serverPwButton: hover {
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #6c7c7c), color-stop(1, #44b395));
	background: -moz-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -webkit-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -o-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -ms-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: linear-gradient(to bottom, #6c7c7c 5%, #44b395 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#6c7c7c', endColorstr='#44b395',GradientType=0);
	background-color: #6c7c7c;
}

#serverPwButton: active {
	position: relative;
	top: 1px;
}

#serverPassword {
	height: 16%;
	width: 50%;
 	position: absolute;
    top: 40%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#labelServerPw {
	font: 20px;
	position: absolute;
	top: 20%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
	max-width: 400px;
  }
  
.loginPW{
	background: #eee;
	width: 35%;
	height: 45%;
	font: 18px Arial;
	font-color: black;
 	position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 9px;
    -moz-border-radius: 9px;
	border-radius: 9px;
	display: none;
	outline: none;
}

#loginLabel {
	font: 20px;
	position: absolute;
	top: 20%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
	max-width: 400px;
}

#signUpLabel {
	font: 20px;
	position: absolute;
	top: 10%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
	max-width: 400px;
}

#yourPictureLabel {
	font: 13px;
	position: absolute;
	top: 15%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
	max-width: 400px;
}

#avatar {
	font: 16px;
	position: absolute;
	top: 30%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
	max-width: 400px;
}

#username {
	height: 16%;
	width: 50%;
 	position: absolute;
    top: 40%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;  
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;	
	outline: none;
}

#usernameSignUp {
	height: 9%;
	width: 50%;
 	position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;  
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;	
	outline: none;
}


#password{
	height: 16%;
	width: 50%;
 	position: absolute;
    top: 60%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#passwordSignUp{
	height: 9%;
	width: 50%;
 	position: absolute;
    top: 62%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
	margin-top: 0.5%;
}

#passwordVerification{
	height: 9%;
	width: 50%;
 	position: absolute;
    top: 75%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#login {
	-moz-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	-webkit-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	box-shadow: inset 0px 1px 3px 0px #91b8b3;
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #44b395), color-stop(1, #6c7c7c));
	background: -moz-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -webkit-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -o-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -ms-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: linear-gradient(to bottom, #44b395 5%, #6c7c7c 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#44b395', endColorstr='#6c7c7c',GradientType=0);
	background-color: #44b395;
	border: 1px solid #566963;
	display: inline-block;
	cursor: pointer;
	color: #ffffff;
	font-family: Arial;
	font-size: 15px;
	font-weight: bold;
	padding: 11px 23px;
	text-decoration: none;
	text-shadow: 0px -1px 0px #2b8a7c;
	position: absolute;
    top: auto;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
    margin-top: 60%;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#login:hover {
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #6c7c7c), color-stop(1, #44b395));
	background: -moz-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -webkit-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -o-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -ms-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: linear-gradient(to bottom, #6c7c7c 5%, #44b395 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#6c7c7c', endColorstr='#44b395',GradientType=0);
	background-color: #6c7c7c;
}

#login:active {
	position: relative;
	top: 1px;
}

#signUp {
	-moz-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	-webkit-box-shadow: inset 0px 1px 3px 0px #91b8b3;
	box-shadow: inset 0px 1px 3px 0px #91b8b3;
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #44b395), color-stop(1, #6c7c7c));
	background: -moz-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -webkit-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -o-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: -ms-linear-gradient(top, #44b395 5%, #6c7c7c 100%);
	background: linear-gradient(to bottom, #44b395 5%, #6c7c7c 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#44b395', endColorstr='#6c7c7c',GradientType=0);
	background-color: #44b395;
	border: 1px solid #566963;
	display: inline-block;
	cursor: pointer;
	color: #ffffff;
	font-family: Arial;
	font-size: 15px;
	font-weight: bold;
	padding: 11px 23px;
	text-decoration: none;
	text-shadow: 0px -1px 0px #2b8a7c;
	position: absolute;
    top: auto;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
    margin-top: 85%;
	-webkit-border-radius: 5px;
    -moz-border-radius: 5px;
	border-radius: 5px;
	outline: none;
}

#signUp:hover {
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #6c7c7c), color-stop(1, #44b395));
	background: -moz-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -webkit-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -o-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: -ms-linear-gradient(top, #6c7c7c 5%, #44b395 100%);
	background: linear-gradient(to bottom, #6c7c7c 5%, #44b395 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#6c7c7c', endColorstr='#44b395',GradientType=0);
	background-color: #6c7c7c;
}

#signUp:active {
	position: relative;
	top: 1px;
}

#signUpLink{
	 background:none!important;
     border:none; 
     padding:0!important;
     font: inherit;
     border-bottom:1px solid #444; 
     cursor: pointer;
	 position: absolute;
     top: auto;
     left: 50%;
     transform: translateX(-50%) translateY(-50%);
     width: 50%;
     margin-top: 80%;
	 outline: none;
}


#credUnvalidError {
	position: absolute;
      top: 90%;
    left: 67%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
	display: none;
}

#accountError {
	position: absolute;
    top: 90%;
    left: 67%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
	display: none;
}

#serverWrongPWD {
	position: absolute;
    top: 64%;
    left: 67%;
    transform: translateX(-50%) translateY(-50%);
    width: 50%;
	font: 15px Arial; 
	color: red; 
	margin-top: 5px;
	display: none;
}

.box {
	background: #000;
	padding: 3px;
	position: fixed;
	bottom: 0;
	width: 100%;
	float: left;
	display: none;
}

.box input {
	border: 0;
	padding: 10px;
	display: none;
}

.sideDiv {
	background: #C6C6C6;
	border-left: 3px solid;
	padding: 5px;
	font: 25px impact, sans-serif;
	float: right;
	width: 17.4%;
	height: 95%;
	margin-left: 6px;
	margin-right: 3px;
	position: fixed;
	right: 0;
	display: none;
}

#onlineUser {
	overflow-y: auto;
	background-color: #eee;
	padding: 10px;
	font: 15px arial;
	width: 100%;
	height: 250px;
	margin-top: 8px;
	margin-bottom: 30px;
	border: 1px solid #000;
}

#messages {
	overflow: auto;
	width: 84%
}
#message {
	width: 82.5%;
	float: left;
}
#send {
	height: 35px;
	width: 17.3%;
	background: #2EBFB5;
	float: right;
}

#upload {
	font: 15px Arial;
	position: fixed;
	bottom: 6.7%;
	width: 17.67%;
	height: 5.7%;
	background-color: #2EBFB5;
	text-align: center;
	float: right;
	right: 0;
	border-left: 3px solid;
	border-top: 3px solid;
	border-right: 3px solid;
	display: none;
}

#upload:hover {
	background-color: #eee;
}

#uploadLabel {
	font: 13px Arial;
	position: fixed;
	margin-top: 0.5%;
	margin-left: 5.9%;
	width: 150x;
	heigth: 20px;
}

#messagesDiv {
	overflow: auto;
	top: 0;
	margin-bottom: 6%;
	display: none;
}
#messages li {
	padding: 5px;
}

#messages li:nth-child(odd) {
	background: #eee;
}

.signUpDiv{
	background: #eee;
	width: 60%;
	height: 70%;
	font: 18px Arial;
	font-color: black;
 	position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    max-width: 400px;
	-webkit-border-radius: 9px;
    -moz-border-radius: 9px;
	border-radius: 9px;
	display: none;
	outline: none;
}

</style>

<body>
	<div class="serverPW">
		<label id="labelServerPw"><b>Server password</b></label>
		<form id="serverLogin" action="">
			<input id= "serverPassword" type="password" class= "serverPwClass" placeholder=" Password"/>
			<input id= "serverPwButton" type="submit" value= "Send"/>
		</form>
	</div>
		<label id="serverWrongPWD">Wrong credentials! Please try again.</label>

	<div class = "loginPW">
		<label id="loginLabel"><b>Login</b></label>
		<form id ="loginEvent" action="">
			<input id="username" type="text" class="usClass" placeholder=" Username" /><p/>
			<input id= "password" type="password" class="pwClass" placeholder=" Password"/>
			<input id="login" type="submit" value="Log In" />
			<!-- Link um sich zu registrieren -->
			
		</form>
		<form id="signUpLinkForm" action="">
			<button id ="signUpLink">Sign up?</button>
		</form>
	</div>
	<label id="accountError" style="font: 15px Arial; color: red; margin-top: 5px">Wrong credentials! Please try again.</label>
	
	<div class="signUpDiv">
		<label id="signUpLabel"><b>Sign Up</b></label>
		<img id="avatar" width="100" height="100" src="image/avatar.jpg"/>
		<form id ="signUpEvent" action="">
			<input id="usernameSignUp" type="text" class="usernameSignUpClass" placeholder=" Username" />
			<input id= "passwordSignUp" type="password" class="pwdSignUpClass" placeholder=" Password"/>
			<input id= "passwordVerification" type="password" class="pwdVfcSignUpClass" placeholder=" Re-enter password"/>
			<input id="signUp" type="submit" value="Sign Up" />
		</form>
	</div>
	
	<div class="sideDiv">
		<h1><center>Empol</center></h1>	
		<form id= "signinEvent" action="">
			<label id="usernameError" style="font: 15px Arial; color: red; margin-top: 5px">Username is already taken.</label>
			<label id="unvalidError" style="font: 15px Arial; color: red; margin-top: 5px">Unvalid! Please try again.</label>
			<label id="successfullyNotification" style="font: 15px Arial; color: red; margin-top: 5px">You are signed in successfully! Please Login.</label>
		</form>
		<div id="onlineUser"></div>
	</div>

	<div id="upload">
		<form id="sendMedia" method="post" enctype="multipart/form-data">
			<label id="uploadLabel" for="media" class="btn">Upload File</label> <input
				id="media" type="file" disabled="disabled" value="Datei Upload" ="visibility: hidden" />
		</form>
	</div>

	<div id="messagesDiv" >
		<ul id="messages"></ul>
	</div>
	
	<div class="box" >
		<form id="sendEvent" action="">
			<input  class="msgClass" placeholder="write something..." />
			<button id="send" disabled="disabled">Send</button>
		</form>
	</div>
	<script src="/socket.io/socket.io.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>

	<script>
	var socket = io();
	$('.serverPW').show();
	$('#send').prop('disabled', true);
	$('#media').prop('disabled', true);
		
		$('#serverLogin').submit(function(){
			if($('.serverPwClass').val() != ""){
				var password = $('#serverPassword').val();
				socket.emit('pwdForServerEmpolChatRoom', {password: password}, function(data){
					if(data == true){
						$('.serverPW').hide();
						$('.loginPW').show();
					} else {
						//$('serverWrongPWD').show();
						console.log("Falsches PWD");
					}
				});	
			}
			return false;
		});
		
		socket.on('wrongCredentials', function(data) {
			$('serverWrongPWD').show();
		});
		
		$('#loginEvent').submit(function() {
			var username = $('#username').val();
			var password = $('#password').val();
			if (($('.usClass').val() == "" && $('.pwClass').val() == "") | ($('.usClass').val() == "" || $('.pwClass').val() == "")){
				$('#accountError').show();
			} else {
				socket.emit('logInUser',{username : username, password : password}, function(data) {
					if (data == false) {
						$('#accountError').show();				
					} else {
						socket.username = username;
						socket.password = password;
						$('#accountError').hide();
						$('#messages').show();
						$('#onlineUser').show();
						$('#send').prop('disabled',false);
						$('#media').prop('disabled',false);
					}
				});
			}
			return false;
		});
		
		$('#signUpLinkForm').submit(function() {
			$('.loginPW').hide();
			$('.signUpDiv').show();	
			
			return false;
		});
		
		$('#signinEvent').submit(function() {
			if (($('.usClass').val() == "" && $('.pwClass').val() == "") | ($('.usClass').val() == "" || $('.pwClass').val() == "")){
				$('#unvalidError').show();
			} else {
				socket.emit('signInUser',{username : $('#username').val(), password : $('#password').val()},
						function(data) {
							if (data == false) {
								$('#usernameError').show();
							} else {
								socket.username = $('#username').val();
								socket.password = $('#password').val();
								$('#unvalidError').hide();
								$('#usernameError').hide();
							}
						});
					}
			return false;			
		});
		
		socket.on('signInSuccessfully', function(data) {
			$('#successfullyNotification').show();
		});
		
		socket.on('logInUserEmit', function(logIn) {
			var time = new Date(logIn.timezone);
			$('#messages').append(
					$('<li>').append(
							$('<i>').text(
									'['
											+ time.getFullYear()
											+ '/'
											+ (time.getMonth() + 1)
											+ '/'
											+ time.getDate()
											+ ' '
											+ (time.getHours() < 10 ? '0'
													+ time.getHours() : time
													.getHours())
											+ ':'
											+ (time.getMinutes() < 10 ? '0'
													+ time.getMinutes() : time
													.getMinutes()) + '] '),
							$('<b>').text(
									logIn.username),
							$('<strong style="color:#20B2AA">').text(
								' has joined the chatroom: '),$('<b>').text('home')));
		});
		
		/*
		This method listens to the server and 
		it fills the onlineUser div with the array which contains the online users.
		 */
		socket.on('usernames', function(data) {
			var empty = '<b>Online user / Room:</b>';
			for (i = 0; i < data.userList.length; i++) {
				empty = empty + "<br/>- " + data.userList[i] + " / " + data.roomList[data.userList[i]];
			}
			$('#onlineUser').html(empty);
		});
		
		/*
		This method listens to the server and gets the username and throws a
		message when the user clicks to  the logout button
		After the logout the send and the upload button will be disabled again.
		 */
		socket.on('logOutUserEmit', function(logOut) {
			var time = new Date(logOut.timezone);
			$('#messages').append(
					$('<li>').append(
							$('<i>').text(
									'['
											+ time.getFullYear()
											+ '/'
											+ (time.getMonth() + 1)
											+ '/'
											+ time.getDate()
											+ ' '
											+ (time.getHours() < 10 ? '0'
													+ time.getHours() : time
													.getHours())
											+ ':'
											+ (time.getMinutes() < 10 ? '0'
													+ time.getMinutes() : time
													.getMinutes()) + '] '),
							$('<b>').text(
									logOut.name ), $('<strong style="color:#20B2AA;">').text(" has left the chatroom.")));
		});
		
		/*
		This is the eventhandler for the send button. 
		If the message isn't empty then it sends the message with the username to the server.
		Then input of the message will be deleted.
		 */
		$('#sendEvent').submit(function() {
			if ($('.msgClass').val() != "") {
				var username = $('#username').val();
				var textmessage = $('#message').val();
				socket.emit('chat message', {
					text : textmessage,
					name : username
				});
				$('#message').val('');
				return false;
			} else {
				$('#message').val('');
				return false;
			}
		});
		
		/*
		This method listens to the server and appends the messages with the current date 
		 */
		socket.on('chat message', function(msg) {
			if(socket.username != undefined){
			time = new Date(msg.timezone);
			$('#messages').append(
					$('<li>').append(
							$('<span>').text(
									'['
											+ time.getFullYear()
											+ '/'
											+ (time.getMonth() + 1)
											+ '/'
											+ time.getDate()
											+ ' '
											+ (time.getHours() < 10 ? '0'
													+ time.getHours() : time
													.getHours())
											+ ':'
											+ (time.getMinutes() < 10 ? '0'
													+ time.getMinutes() : time
													.getMinutes()) + ']'),
							$('<b>').text(' ' + msg.name + ': '),
							$('<span>').text(msg.text)));
			}
		});
		
		/*
		This method listens to the sever and goes trough the method if the user wants to write a private message.
		It appends the the private with the current date.
		 */
		socket
				.on('private message', function(msg) {
							time = new Date(msg.timezone);
							$('#messages').append($('<li>').append($('<span>').text(
																			'['
																					+ time
																							.getFullYear()
																					+ '/'
																					+ (time
																							.getMonth() + 1)
																					+ '/'
																					+ time
																							.getDate()
																					+ ' '
																					+ (time
																							.getHours() < 10 ? '0'
																							+ time
																									.getHours()
																							: time
																									.getHours())
																					+ ':'
																					+ (time
																							.getMinutes() < 10 ? '0'
																							+ time
																									.getMinutes()
																							: time
																									.getMinutes())
																					+ '] '),
															$('<b>')
																	.text(
																			' private chat between '
																					+ msg.name
																					+ ' and '
																					+ msg.destinationName
																					+ ': '),
															$('<span>').text(
																	msg.text)));
						});
		
		/*
		This method appends a message if the user wants to write a private message to a user sho doesn't exists.
		 */
		socket
				.on(
						'UnvalidNameError',
						function(msg) {
							time = new Date(msg.timezone);
							$('#messages')
									.append(
											$('<li>')
													.append(
															$('<span>')
																	.text(
																			'['
																					+ time
																							.getFullYear()
																					+ '/'
																					+ (time
																							.getMonth() + 1)
																					+ '/'
																					+ time
																							.getDate()
																					+ ' '
																					+ (time
																							.getHours() < 10 ? '0'
																							+ time
																									.getHours()
																							: time
																									.getHours())
																					+ ':'
																					+ (time
																							.getMinutes() < 10 ? '0'
																							+ time
																									.getMinutes()
																							: time
																									.getMinutes())
																					+ '] '),
															$(
																	'<strong style="color:red">')
																	.text(
																			' This username doesnt exist. Choose an online user!'),
															$('<span>').text(
																	msg.text)));
						});
		
		/*It goes through this method if the user clicks to the upload button
		 Getting the name of a file before it is uploaded with the originalEvent.
		 A file reader will be created and the event onload will be triggert read operation is completed successfully.
		 Then it sends the result to the server.
		 */
		$('#sendMedia').on('change', function(e) {
			if(socket.username != undefined){
			var media = e.originalEvent.target.files[0];
			var reader = new FileReader();
			reader.onload = function(evt) {
				var username = $('#username').val();
				socket.emit('userImage', {
					result : evt.target.result,
					username : username
				});
			};
			// Read in the image file as a data URL.
			reader.readAsDataURL(media);
			}
		});
		
		/*
		 This method appends the image in the messages div.
		 It gets the image from the server.
		 */
		socket.on('userImageEmit', function(image) {
			if(socket.username != undefined){
			time = new Date(image.timezone);
			$('#messages').append(
					$('<li>').append(
							$('<span>').text(
									'[' + time.getFullYear() + '/'
											+ (time.getMonth() + 1) + '/'
											+ time.getDate() + ' '
											+ time.getHours() + ':'
											+ time.getMinutes() + '] '),
							$('<b> ').text(
									' ' + image.username), $('<strong style="color:#20B2AA;">').text(' has sent an image:'),
							'</p> <img width="220" height="190" src="' + image.result + '"/>'));
			$('#media').val('');
			}
		});
		
		/*
		 Here all users will see a notification that a room is created.
		 */
		socket.on('chatroomBroadcast', function(msg) {
			if(socket.username != undefined){
				time = new Date(msg.timezone);
				$('#messages')
				.append(
						$('<li>')
								.append(
										$('<span>')
												.text(
														'['
																+ time
																		.getFullYear()
																+ '/'
																+ (time
																		.getMonth() + 1)
																+ '/'
																+ time
																		.getDate()
																+ ' '
																+ (time
																		.getHours() < 10 ? '0'
																		+ time
																				.getHours()
																		: time
																				.getHours())
																+ ':'
																+ (time
																		.getMinutes() < 10 ? '0'
																		+ time
																				.getMinutes()
																		: time
																				.getMinutes())
																+ '] '),
										$('<b>')
												.text(msg.name),
												$('<strong style="color:#20B2AA;">').text(' created the room: '),
												$('<b>').text(msg.chatroom )));
		}
		});
		
		/*
		 After you created/joined a chatroom you get this notification.
		 */
		socket.on('emptyChat', function(msg){
			$('#messages').empty();
			var time = new Date(msg.timezone);
			$('#messages').append($('<li>').append($('<i>').text(
									'['
											+ time.getFullYear()
											+ '/'
											+ (time.getMonth() + 1)
											+ '/'
											+ time.getDate()
											+ ' '
											+ (time.getHours() < 10 ? '0'
													+ time.getHours() : time
													.getHours())
											+ ':'
											+ (time.getMinutes() < 10 ? '0'
													+ time.getMinutes() : time
													.getMinutes()) + '] '),
							$('<strong style="color:#20B2AA;">').text(
									" You have joined the chatroom " ),
									$('<b>').text(msg.chatroom ),
									$('<strong style="color:#20B2AA;">').text(". Room password: "),
									$('<b>').text(msg.pwd)));
		});
		
		/*
		 If a room exists already, you get this notification.
		 */
		socket.on('roomExistsWarning', function(msg){ 
			if(socket.username != undefined){ 
				time = new Date(msg.timezone); 
				$('#messages').append( $('<li>').append( $('<span>') 
						.text( '[' + time .getFullYear() + '/' + (time .getMonth() + 1) + '/' + time .getDate() + ' ' 
						         + (time .getHours() < 10 ? '0' + time .getHours() : time .getHours()) + ':' 
						         + (time .getMinutes() < 10 ? '0' + time .getMinutes() : time .getMinutes()) + '] '), 
						         $('<strong style="color:red">') .text('The room " '+ msg.chatroom + ' "is already created! Please try again."'))); } 
			});
		
		/*
		 If a user changed a room all users get a notification, that the user changes the room.
		 */
		socket.on('userChangedRoom', function (msg){ 
			if(socket.username != undefined){ 
				time = new Date(msg.timezone); $('#messages').append( $('<li>').append( $('<span>') 
						.text( '[' + time .getFullYear() + '/' + (time .getMonth() + 1) + '/' + time .getDate() + ' ' 
						         + (time .getHours() < 10 ? '0' + time .getHours() : time .getHours()) + ':' 
						         + (time .getMinutes() < 10 ? '0' + time .getMinutes() : time .getMinutes()) + '] '), 
						         $('<b>') .text( msg.name ),
						         $('<strong style="color:#20B2AA;">') .text(' changed into the room: '), 
						         $('<b>').text(msg.chatroom))); } });
		
		
		/*
		 You get this notification, if you entered a wrong password for a specific room.
		 */
		socket.on('wrongPWforRoom', function(msg){ 
			if(socket.username != undefined){ 
				time = new Date(msg.timezone); $('#messages') .append( $('<li>') .append( $('<span>') 
						.text( '[' + time .getFullYear() + '/' + (time .getMonth() + 1) + '/' + time .getDate() 
						         + ' ' + (time .getHours() < 10 ? '0' + time .getHours() : time .getHours()) + ':' 
						         + (time .getMinutes() < 10 ? '0' + time .getMinutes() : time .getMinutes()) + '] '), 
						         $('<strong style="color:red">') 
						         .text('You entered the wrong password for the room "'+ msg.chatroom + '"'))); 
		}});
		
		/*
		 If a room doesnt exist, you will get this notification.
		 */
		socket.on('roomDoesntExistsWarning', function(msg){ 
			if(socket.username != undefined){ 
				time = new Date(msg.timezone); $('#messages') .append( $('<li>') .append( $('<span>') 
						.text( '[' + time .getFullYear() + '/' + (time .getMonth() + 1) + '/' + time .getDate() 
						         + ' ' + (time .getHours() < 10 ? '0' + time .getHours() : time .getHours()) + ':' 
						         + (time .getMinutes() < 10 ? '0' + time .getMinutes() : time .getMinutes()) + ']'), 
						         $('<strong style="color:red">') .text('The room " '+ msg.chatroom + ' doesnt exist!'))); } });
		
		/*
		This method is for disabling our bottons.
		 */
		jQuery.fn.extend({ 
			disable : function(state) {
				return this.each(function() {
					this.disabled = state;
				});
			}
		}); 
	</script>
</body>
</html>